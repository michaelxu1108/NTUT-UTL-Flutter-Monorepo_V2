# 2025-12-11 æ›´æ–°ï¼šflutter_blue_plus å‡ç´šèˆ‡ UI é‡æ–°è¨­è¨ˆ

## ğŸ“… æ›´æ–°æ—¥æœŸ

2025-12-11

## ğŸ“ æ›´æ–°æ‘˜è¦

æœ¬æ¬¡æ›´æ–°åŒ…å«ä¸‰å€‹ä¸»è¦éƒ¨åˆ†ï¼š

1. å‡ç´š `flutter_blue_plus` åˆ°æœ€æ–°ç‰ˆæœ¬ 2.0.2 ä¸¦é…ç½®å…è²»æˆæ¬Š
2. å¯¦ä½œå‡è³‡æ–™æ¨¡æ“¬åŠŸèƒ½ï¼ˆMock Modeï¼‰
3. é‡æ–°è¨­è¨ˆéŸ¿æ‡‰å¼ UIï¼Œæ”¯æ´æ©«ç‰ˆå’Œå‚ç›´ç‰ˆä½ˆå±€

---

## 1ï¸âƒ£ flutter_blue_plus å‡ç´š

### ğŸ“¦ ç‰ˆæœ¬è®Šæ›´

| å¥—ä»¶                                 | èˆŠç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ |
| ------------------------------------ | ------ | ------ |
| flutter_blue_plus                    | 1.36.8 | 2.0.2  |
| flutter_blue_plus_android            | 7.0.4  | 8.0.1  |
| flutter_blue_plus_darwin             | 7.0.3  | 8.0.1  |
| flutter_blue_plus_linux              | 7.0.3  | 8.0.1  |
| flutter_blue_plus_platform_interface | 7.0.0  | 8.0.1  |
| flutter_blue_plus_web                | 7.0.2  | 8.0.1  |

### ğŸ”§ API è®Šæ›´

#### æ–°å¢å¿…è¦åƒæ•¸ï¼š`license`

flutter_blue_plus 2.0.2 è¦æ±‚åœ¨é€£æ¥è—ç‰™è£ç½®æ™‚æä¾›æˆæ¬Šåƒæ•¸ï¼š

```dart
// èˆŠç‰ˆï¼ˆ1.xï¼‰
await device.connect(
  timeout: const Duration(seconds: 15),
  autoConnect: false,
);

// æ–°ç‰ˆï¼ˆ2.xï¼‰
await device.connect(
  license: License.free,  // âœ… å¿…è¦åƒæ•¸
  timeout: const Duration(seconds: 15),
  autoConnect: false,
);
```

### ğŸ“„ æˆæ¬Šèªªæ˜

ä½¿ç”¨ `License.free` é©ç”¨æ–¼ï¼š

- å€‹äººä½¿ç”¨è€…
- éç‡Ÿåˆ©çµ„ç¹”
- æ•™è‚²æ©Ÿæ§‹
- å“¡å·¥æ•¸å°‘æ–¼ 50 äººçš„å°å‹çµ„ç¹”

### ğŸ“ ä¿®æ”¹çš„æª”æ¡ˆ

- `apps/bracelet_app/pubspec.yaml` - æ›´æ–°ç‰ˆæœ¬è™Ÿ
- `apps/bracelet_app/lib/infrastructure/source/bluetooth/bracelet_bluetooth_module.dart` - æ·»åŠ  license åƒæ•¸

---

## 2ï¸âƒ£ å‡è³‡æ–™æ¨¡æ“¬åŠŸèƒ½ï¼ˆMock Modeï¼‰

### ğŸ¯ åŠŸèƒ½ç›®çš„

åœ¨æ²’æœ‰å¯¦é«”æ‰‹ç’°è£ç½®æ™‚ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡æ“¬è³‡æ–™ä¾†æ¸¬è©¦ UI å’Œè³‡æ–™è™•ç†é‚è¼¯ã€‚

### ğŸ“ æ–°å¢çš„æª”æ¡ˆ

#### `mock_bracelet_bluetooth_module.dart`

ä½ç½®ï¼š`apps/bracelet_app/lib/infrastructure/source/bluetooth/`

**åŠŸèƒ½ç‰¹æ€§ï¼š**

- è‡ªå‹•ç”Ÿæˆæ¨¡æ“¬æ„Ÿæ¸¬å™¨è³‡æ–™ï¼ˆ50 Hz å–æ¨£ç‡ï¼Œæ¯ 20ms ä¸€ç­†ï¼‰
- åŒ…å« ICM-20948 ä¹è»¸ IMU è³‡æ–™ï¼ˆåŠ é€Ÿåº¦ã€é™€èºå„€ã€ç£åŠ›è¨ˆï¼‰
- åŒ…å« 4 é¡† MLX90393 ç£åŠ›è¨ˆè³‡æ–™
- æ¨¡æ“¬æ‰‹æŒ‡å½æ›²å‹•ä½œçš„æ­£å¼¦æ³¢æ¨¡å¼

**æ¨¡æ“¬è³‡æ–™ç¯„åœï¼š**

```dart
// ICM-20948 åŠ é€Ÿåº¦è¨ˆï¼ˆéœæ­¢ç‹€æ…‹ + å¾®å°éœ‡å‹•ï¼‰
accX, accY: Â±50 LSB/g
accZ: 16384 Â± 100 LSB/g (Z è»¸ç´„ 1g)

// ICM-20948 é™€èºå„€ï¼ˆå¾®å°æ—‹è½‰ï¼‰
gyroX, gyroY, gyroZ: Â±30 LSB/dps

// ICM-20948 ç£åŠ›è¨ˆï¼ˆåœ°ç£å ´ï¼‰
magX: 200 Â± 50
magY: 100 Â± 50
magZ: -300 Â± 50

// MLX90393 ç£åŠ›è¨ˆï¼ˆæ‰‹æŒ‡å½æ›²å‹•ä½œï¼‰
mlxX: sin(time) Ã— 1000-1200 + 32768 Â± noise
mlxY, mlxZ: 32768 Â± 150-200
```

### ğŸ“ ä¿®æ”¹çš„æª”æ¡ˆ

#### `main.dart`

æ–°å¢æ¨¡æ“¬æ¨¡å¼é–‹é—œï¼š

```dart
/// æ¨¡æ“¬è³‡æ–™é…ç½®
const bool useMockData = true;  // true: Mock æ¨¡å¼, false: çœŸå¯¦è—ç‰™æ¨¡å¼
```

#### `bracelet_change_notifier.dart`

æ”¯æ´æ³¨å…¥ä¸åŒçš„è—ç‰™æ¨¡çµ„ï¼š

```dart
class BraceletChangeNotifier extends ChangeNotifier {
  final dynamic _bluetoothModule;

  BraceletChangeNotifier({dynamic bluetoothModule})
      : _bluetoothModule = bluetoothModule ?? BraceletBluetoothModule();
}
```

#### `home_screen.dart`

Mock æ¨¡å¼ä¸‹è‡ªå‹•é€£æ¥ï¼š

```dart
@override
void initState() {
  super.initState();

  // Mock æ¨¡å¼ä¸‹è‡ªå‹•é€£æ¥
  if (useMockData) {
    WidgetsBinding.instance.addPostFrameCallback((_) {
      _autoConnectMockDevice(context);
    });
  }
}
```

### ğŸ® ä½¿ç”¨æ–¹å¼

**å•Ÿç”¨ Mock æ¨¡å¼ï¼š**

1. é–‹å•Ÿ `apps/bracelet_app/lib/main.dart`
2. è¨­å®š `const bool useMockData = true;`
3. é‡æ–°åŸ·è¡Œ App
4. App æœƒè‡ªå‹•é€£æ¥ä¸¦é–‹å§‹ç”Ÿæˆå‡è³‡æ–™

**åˆ‡æ›åˆ°çœŸå¯¦æ¨¡å¼ï¼š**

1. è¨­å®š `const bool useMockData = false;`
2. é‡æ–°åŸ·è¡Œ App
3. éœ€è¦æ‰‹å‹•æœå°‹ä¸¦é€£æ¥è—ç‰™è£ç½®

---

## 3ï¸âƒ£ UI é‡æ–°è¨­è¨ˆ

### ğŸ¨ éŸ¿æ‡‰å¼ä½ˆå±€

ä½¿ç”¨ `OrientationBuilder` å’Œ `LayoutBuilder` å¯¦ç¾è‡ªé©æ‡‰ä½ˆå±€ã€‚

#### å‚ç›´ç‰ˆï¼ˆPortraitï¼‰ä½ˆå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  App Bar                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•¸å€¼å¡ç‰‡ï¼ˆ4å€‹ä¸¦æ’ï¼‰        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”      â”‚
â”‚ â”‚MLX0â”‚MLX1â”‚MLX2â”‚MLX3â”‚      â”‚
â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚
â”‚      æ³¢å½¢åœ–è¡¨å€åŸŸ           â”‚
â”‚      (60% ç©ºé–“)            â”‚
â”‚                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚
â”‚      æ§åˆ¶é¢æ¿              â”‚
â”‚      (40% ç©ºé–“)            â”‚
â”‚                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ©«ç‰ˆï¼ˆLandscapeï¼‰ä½ˆå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  App Bar           â”‚          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚ è¿·ä½ æ•¸å€¼å¡ç‰‡        â”‚          â”‚
â”‚ [MLX0][MLX1]       â”‚  æ§åˆ¶é¢æ¿ â”‚
â”‚ [MLX2][MLX3]       â”‚          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  (320-   â”‚
â”‚                    â”‚   400px) â”‚
â”‚                    â”‚          â”‚
â”‚   æ³¢å½¢åœ–è¡¨å€åŸŸ      â”‚          â”‚
â”‚                    â”‚          â”‚
â”‚                    â”‚          â”‚
â”‚                    â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“Š åœ–è¡¨åˆ†çµ„é¡¯ç¤º

ä½¿ç”¨ **Tab æ¨™ç±¤é ** è§£æ±º 12 æ¢æ³¢å½¢æ“ å£“å•é¡Œï¼š

**Tab çµæ§‹ï¼š**

1. **å…¨éƒ¨** - é¡¯ç¤º 4 å€‹ MLX çš„ X è»¸æ•¸æ“šï¼ˆç°¡åŒ–è¦–åœ–ï¼‰
2. **MLX0 (æ‹‡æŒ‡)** - é¡¯ç¤º Xã€Yã€Z ä¸‰è»¸æ³¢å½¢
3. **MLX1 (é£ŸæŒ‡)** - é¡¯ç¤º Xã€Yã€Z ä¸‰è»¸æ³¢å½¢
4. **MLX2 (ä¸­æŒ‡)** - é¡¯ç¤º Xã€Yã€Z ä¸‰è»¸æ³¢å½¢
5. **MLX3 (ç„¡åæŒ‡)** - é¡¯ç¤º Xã€Yã€Z ä¸‰è»¸æ³¢å½¢

**å„ªé»ï¼š**

- æ¯å€‹ Tab åªé¡¯ç¤º 3-4 æ¢ç·šï¼Œæ¸…æ™°æ˜“è®€
- å¯ä»¥å°ˆæ³¨æŸ¥çœ‹ç‰¹å®šæ„Ÿæ¸¬å™¨çš„è³‡æ–™
- æ¸›å°‘åœ–ä¾‹æ“æ“ å•é¡Œ

### ğŸ´ æ•¸å€¼å¡ç‰‡è¨­è¨ˆ

#### è¿·ä½ å¡ç‰‡ï¼ˆæ©«ç‰ˆç”¨ï¼‰

```dart
Widget _buildMiniDataCard(String title, int x, int y, int z, Color color) {
  return Card(
    color: color.withOpacity(0.1),  // æ·ºè‰²èƒŒæ™¯
    child: Column(
      children: [
        Text(title, style: TextStyle(color: color, fontWeight: bold)),
        Text('X:$x', fontSize: 10),
        Text('Y:$y', fontSize: 10),
        Text('Z:$z', fontSize: 10),
      ],
    ),
  );
}
```

#### å®Œæ•´å¡ç‰‡ï¼ˆå‚ç›´ç‰ˆç”¨ï¼‰

```dart
Widget _buildDataCard(String title, int x, int y, int z, Color color) {
  return Card(
    color: color.withOpacity(0.1),  // æ·ºè‰²èƒŒæ™¯
    child: Column(
      children: [
        Text(title, style: TextStyle(color: color, fontWeight: bold)),
        Text('X: $x', fontSize: 13),
        Text('Y: $y', fontSize: 13),
        Text('Z: $z', fontSize: 13),
      ],
    ),
  );
}
```

### ğŸ¨ é¡è‰²é…ç½®

| æ„Ÿæ¸¬å™¨ | é¡è‰²          | ç”¨é€”   |
| ------ | ------------- | ------ |
| MLX0   | è—è‰² (Blue)   | æ‹‡æŒ‡   |
| MLX1   | ç´…è‰² (Red)    | é£ŸæŒ‡   |
| MLX2   | ç¶ è‰² (Green)  | ä¸­æŒ‡   |
| MLX3   | æ©˜è‰² (Orange) | ç„¡åæŒ‡ |

### ğŸ“ ä¿®æ”¹çš„æª”æ¡ˆ

#### `home_screen.dart`

- æ–°å¢ `_buildLandscapeLayout()` - æ©«ç‰ˆä½ˆå±€
- æ–°å¢ `_buildPortraitLayout()` - å‚ç›´ç‰ˆä½ˆå±€
- æ–°å¢ `_buildDataCards()` - æ•¸å€¼å¡ç‰‡å®¹å™¨
- æ–°å¢ `_buildMiniDataCard()` - è¿·ä½ æ•¸å€¼å¡ç‰‡
- æ–°å¢ `_buildDataCard()` - å®Œæ•´æ•¸å€¼å¡ç‰‡

#### `mlx_chart_view.dart`

- æ”¹ç”¨ `DefaultTabController` å’Œ `TabBarView`
- æ–°å¢ `_buildAllChart()` - é¡¯ç¤ºå…¨éƒ¨ MLX çš„ X è»¸
- æ–°å¢ `_buildSingleMlxChart()` - é¡¯ç¤ºå–®ä¸€ MLX çš„ä¸‰è»¸

---

## ğŸ§ª æ¸¬è©¦çµæœ

### âœ… ç·¨è­¯æ¸¬è©¦

- Gradle å»ºç½®æˆåŠŸï¼ˆ6.3 ç§’ï¼‰
- APK å»ºç½®æˆåŠŸ
- å®‰è£åˆ°æ¨¡æ“¬å™¨æˆåŠŸ

### âœ… åŠŸèƒ½æ¸¬è©¦

- Mock æ¨¡å¼è‡ªå‹•é€£æ¥æˆåŠŸ
- å‡è³‡æ–™ç”Ÿæˆæ­£å¸¸ï¼ˆ50 Hzï¼‰
- æ©«ç‰ˆä½ˆå±€é¡¯ç¤ºæ­£å¸¸
- å‚ç›´ç‰ˆä½ˆå±€é¡¯ç¤ºæ­£å¸¸
- Tab åˆ‡æ›æ­£å¸¸
- æ•¸å€¼å¡ç‰‡å³æ™‚æ›´æ–°æ­£å¸¸

### ğŸ“Š æ—¥èªŒè¼¸å‡º

```
I/flutter: ğŸ”§ åŸ·è¡Œæ¨¡æ“¬æ¨¡å¼ - ä½¿ç”¨æ¨¡æ“¬æ‰‹ç’°è³‡æ–™
I/flutter: ğŸ”§ Running in MOCK MODE - Using simulated bracelet data
I/flutter: ğŸ”§ [Mock] æ¨¡æ“¬é€£æ¥åˆ°è£ç½®:
I/flutter: ğŸ”§ [Mock] é€£æ¥æˆåŠŸï¼Œé–‹å§‹ç”Ÿæˆè³‡æ–™ï¼ˆ50 Hzï¼‰
```

---

## ğŸ“ ä½¿ç”¨èªªæ˜

### é–‹ç™¼æ™‚ä½¿ç”¨ Mock æ¨¡å¼

1. è¨­å®š `useMockData = true`
2. åŸ·è¡Œ App æœƒè‡ªå‹•é€£æ¥
3. é»æ“Šã€Œé–‹å§‹è¨˜éŒ„ã€å³å¯çœ‹åˆ°å‡è³‡æ–™æ³¢å½¢
4. å¯ä»¥æ¸¬è©¦æ‰€æœ‰ UI åŠŸèƒ½ï¼ˆè¨˜éŒ„ã€é‡ç½®ã€åŒ¯å‡ºç­‰ï¼‰

### æ¸¬è©¦å¯¦é«”æ‰‹ç’°

1. è¨­å®š `useMockData = false`
2. åŸ·è¡Œ App
3. é»æ“Šè—ç‰™æœå°‹æŒ‰éˆ•
4. é¸æ“‡æ‰‹ç’°è£ç½®é€£æ¥
5. é–‹å§‹è¨˜éŒ„å’Œæ¸¬è©¦

### æŸ¥çœ‹ä¸åŒæ³¢å½¢

1. é»æ“Šåœ–è¡¨ä¸Šæ–¹çš„ Tab æ¨™ç±¤
2. ã€Œå…¨éƒ¨ã€tab é¡¯ç¤º 4 å€‹æ„Ÿæ¸¬å™¨çš„ X è»¸ç¸½è¦½
3. åˆ‡æ›åˆ°å€‹åˆ¥ tab æŸ¥çœ‹è©³ç´°çš„ä¸‰è»¸æ³¢å½¢
4. æ”¯æ´ç¸®æ”¾å’Œæ‹–æ›³æ“ä½œ

---

## ğŸ”„ ç›¸å®¹æ€§èªªæ˜

### å‘å¾Œç›¸å®¹

- çœŸå¯¦è—ç‰™æ¨¡å¼å®Œå…¨ç›¸å®¹èˆŠç‰ˆåŠŸèƒ½
- è³‡æ–™æ ¼å¼æ²’æœ‰è®Šæ›´
- CSV åŒ¯å‡ºæ ¼å¼ä¿æŒä¸è®Š

### ç ´å£æ€§è®Šæ›´

- éœ€è¦ flutter_blue_plus 2.0.2ï¼ˆä¸ç›¸å®¹ 1.xï¼‰
- é€£æ¥æ–¹æ³•å¿…é ˆåŒ…å« `license` åƒæ•¸

---

## ğŸ› å·²çŸ¥å•é¡Œ

ç„¡

---

## ğŸ“š åƒè€ƒè³‡æ–™

- [flutter_blue_plus å®˜æ–¹æ–‡ä»¶](https://pub.dev/packages/flutter_blue_plus)
- [flutter_blue_plus 2.0 é·ç§»æŒ‡å—](https://pub.dev/packages/flutter_blue_plus/versions/2.0.2)
- [License æˆæ¬Šèªªæ˜](https://pub.dev/packages/flutter_blue_plus#license)

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¨ˆåŠƒ

- [ ] æ¸¬è©¦çœŸå¯¦æ‰‹ç’°è£ç½®çš„è³‡æ–™æ­£ç¢ºæ€§
- [ ] å„ªåŒ–åœ–è¡¨æ¸²æŸ“æ•ˆèƒ½ï¼ˆå¦‚æœè³‡æ–™é‡å¤§æ™‚æœ‰å¡é “ï¼‰
- [ ] æ–°å¢æ›´å¤šåœ–è¡¨é¡å‹ï¼ˆå¦‚é »è­œåˆ†æã€çµ±è¨ˆåœ–ç­‰ï¼‰
- [ ] å¯¦ä½œè³‡æ–™å›æ”¾åŠŸèƒ½
- [ ] æ–°å¢æ‰‹å‹¢è¾¨è­˜æ¼”ç®—æ³•

---

## ğŸ“ è¯çµ¡è³‡è¨Š

å¦‚æœ‰å•é¡Œæˆ–å»ºè­°ï¼Œè«‹è¯ç¹«å°ˆæ¡ˆç¶­è­·è€…ã€‚

---

**æœ€å¾Œæ›´æ–°ï¼š** 2025-12-11
**æ–‡ä»¶ç‰ˆæœ¬ï¼š** 1.0
**App ç‰ˆæœ¬ï¼š** å°šæœªæ¨™è¨˜ï¼ˆå»ºè­°ä¸‹æ¬¡æ›´æ–°æ™‚åŠ å…¥ç‰ˆæœ¬è™Ÿï¼‰
